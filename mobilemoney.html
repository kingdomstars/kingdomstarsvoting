<!DOCTYPE html>
<html>
<head>
  <title>Mobile Money Voting â€“ Kingdom Stars</title>
</head>
<body>

<h2>ğŸ“± Vote with Mobile Money</h2>

<p><strong>Send payment to:</strong></p>
<ul>
  <li>ğŸŸ  Orange Money: <b>07XXXXXX</b></li>
  <li>ğŸ”µ Africell Money: <b>07XXXXXX</b></li>
</ul>

<p><strong>Amount:</strong> Le 5 (example)</p>

<hr>

<h3>Confirm Your Vote</h3>

<input type="text" id="name" placeholder="Your Name"><br><br>
<input type="text" id="phone" placeholder="Your Phone Number"><br><br>
<input type="text" id="txn" placeholder="Transaction ID"><br><br>

<select id="contestant">
  <option>Select Contestant</option>
</select><br><br>

<button onclick="submitMobileVote()">Submit Vote</button>

<p id="msg"></p>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
<script src="script.js"></script>
<script>
db.collection("settings").doc("voting").onSnapshot(doc => {
  if (!doc.exists || doc.data().mobileMoney !== true) {
    document.body.innerHTML = "<h2>ğŸš« Mobile Money Voting is currently closed</h2>";
  }
});
</script>

<script>
db.collection("contestants").get().then(snapshot => {
  const select = document.getElementById("contestant");
  snapshot.forEach(doc => {
    const opt = document.createElement("option");
    opt.value = doc.id;
    opt.textContent = doc.data().name;
    select.appendChild(opt);
  });
});

function submitMobileVote() {
  db.collection("mobileVotes").add({
    name: name.value,
    phone: phone.value,
    transactionId: txn.value,
    contestantId: contestant.value,
    status: "pending",
    time: new Date()
  });

  msg.innerText = "Vote submitted. Await confirmation ğŸ™";
}
</script>

</body>
</html>
