<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Mobile Money Voting â€“ Kingdom Stars</title>
</head>

<body>

<h1>ğŸ“± Kingdom Stars â€“ Mobile Money Voting</h1>

<p><strong>Send payment to:</strong></p>
<ul>
  <li>ğŸŸ  Orange Money: <b>07XXXXXX</b></li>
  <li>ğŸ”µ Africell Money: <b>07XXXXXX</b></li>
</ul>

<hr>

<h3>ğŸ’° Select Vote Bundle</h3>
<select id="bundle">
  <option value="">Choose bundle</option>
  <option value="1">Le 5 â€“ 1 Vote</option>
  <option value="5">Le 20 â€“ 5 Votes</option>
  <option value="15">Le 50 â€“ 15 Votes</option>
</select>

<hr>

<h3>ğŸ“ Confirm Your Vote</h3>

<input type="text" id="name" placeholder="Your Name"><br><br>
<input type="text" id="phone" placeholder="Your Phone Number"><br><br>
<input type="text" id="txn" placeholder="Transaction ID"><br><br>

<select id="contestant">
  <option value="">Select Contestant</option>
</select><br><br>

<button onclick="submitMobileVote()">Submit Vote</button>

<p id="msg"></p>

<!-- ğŸ”¥ FIREBASE SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<!-- ğŸ”§ MAIN CONFIG -->
<script src="script.js"></script>

<!-- ğŸ” ADMIN ON/OFF SWITCH -->
<script>
db.collection("settings").doc("voting").onSnapshot(doc => {
  if (!doc.exists || doc.data().mobileMoney !== true) {
    document.body.innerHTML = "<h2>ğŸš« Mobile Money Voting is currently closed</h2>";
  }
});
</script>

<!-- ğŸ“‹ LOAD CONTESTANTS -->
<script>
db.collection("contestants").orderBy("name").get().then(snapshot => {
  const select = document.getElementById("contestant");
  snapshot.forEach(doc => {
    const opt = document.createElement("option");
    opt.value = doc.id;
    opt.textContent = doc.data().name;
    select.appendChild(opt);
  });
});
</script>

<!-- âœ… SUBMIT VOTE -->
<script>
function submitMobileVote() {
  if (!name.value || !phone.value || !txn.value || !contestant.value || !bundle.value) {
    msg.innerText = "âš ï¸ Please fill all fields";
    return;
  }

  db.collection("mobileVotes").add({
    name: name.value,
    phone: phone.value,
    transactionId: txn.value,
    contestantId: contestant.value,
    votes: Number(bundle.value),
    status: "pending",
    time: new Date()
  });

  msg.innerText = "âœ… Vote submitted. Await confirmation ğŸ™";

  // Optional: clear form
  name.value = "";
  phone.value = "";
  txn.value = "";
  contestant.value = "";
  bundle.value = "";
}
</script>

</body>
</html>
